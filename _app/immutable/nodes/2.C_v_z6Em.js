import"../chunks/DsnmJJEf.js";import{a as et}from"../chunks/B2sZKSvF.js";import{h as H,f as tt,c as at,a as e,av as lt,i as rt,H as st,j as Te,k as Ce,l as _e,z as re,aI as nt,aJ as it,p as Le,w as ot,v as ae,aK as $e,G as ct,o as ut,m as vt,aL as ke,aM as dt,x as Be,y as ft,aN as ht,aO as me,aP as ze,aQ as _t,aR as mt,aS as gt,aT as bt,aU as pt,aV as wt,ak as Et,aW as We,r as Fe,V as Lt,u as xt,aX as yt,aY as Rt,ab as It,B as ge,b as u,aE as T,X as Q,Z as Ut,$ as K,ac as At,a4 as X,a2 as U,a3 as A,a1 as ie,ad as Mt}from"../chunks/CXf8lD5I.js";import{i as se}from"../chunks/DOmrgE74.js";import{l as ne,t as te,a as Ne,s as oe,f as ce,r as Xe}from"../chunks/C5dJEZHt.js";import{b as be}from"../chunks/A9dlLIIu.js";function Dt(t,s,l){for(var r=t.items,n=[],i=s.length,v=0;v<i;v++)bt(s[v].e,n,!0);var h=i>0&&n.length===0&&l!==null;if(h){var _=l.parentNode;pt(_),_.append(l),r.clear(),Z(t,s[0].prev,s[i-1].next)}wt(n,()=>{for(var y=0;y<i;y++){var g=s[y];h||(r.delete(g.k),Z(t,g.prev,g.next)),ze(g.e,!h)}})}function St(t,s,l,r,n,i=null){var v=t,h={flags:s,items:new Map,first:null};H&&tt();var _=null,y=!1,g=new Map,R=lt(()=>{var d=l();return ct(d)?d:d==null?[]:$e(d)}),o,x;function m(){Ot(x,o,h,g,v,n,s,r,l),i!==null&&(o.length===0?_?Be(_):_=Le(()=>i(v)):_!==null&&ft(_,()=>{_=null}))}at(()=>{x??=Et,o=e(R);var d=o.length;if(y&&d===0)return;y=d===0;let M=!1;if(H){var Y=rt(v)===st;Y!==(d===0)&&(v=Te(),Ce(v),_e(!1),M=!0)}if(H){for(var I=null,b,E=0;E<d;E++){if(re.nodeType===nt&&re.data===it){v=re,M=!0,_e(!1);break}var S=o[E],C=r(S,E);b=xe(re,h,I,null,S,C,E,n,s,l),h.items.set(C,b),I=b}d>0&&Ce(Te())}if(H)d===0&&i&&(_=Le(()=>i(v)));else if(ot()){var G=new Set,z=ae;for(E=0;E<d;E+=1){S=o[E],C=r(S,E);var N=h.items.get(C)??g.get(C);N?Ve(N,S,E):(b=xe(null,h,null,null,S,C,E,n,s,l,!0),g.set(C,b)),G.add(C)}for(const[q,w]of h.items)G.has(q)||z.skipped_effects.add(w.e);z.add_callback(m)}else m();M&&_e(!0),e(R)}),H&&(v=re)}function Ot(t,s,l,r,n,i,v,h,_){var y=s.length,g=l.items,R=l.first,o=R,x,m=null,d=[],M=[],Y,I,b,E;for(E=0;E<y;E+=1){if(Y=s[E],I=h(Y,E),b=g.get(I),b===void 0){var S=r.get(I);if(S!==void 0){r.delete(I),g.set(I,S);var C=m?m.next:o;Z(l,m,S),Z(l,S,C),pe(S,C,n),m=S}else{var G=o?o.e.nodes_start:n;m=xe(G,l,m,m===null?l.first:m.next,Y,I,E,i,v,_)}g.set(I,m),d=[],M=[],o=m.next;continue}if(Ve(b,Y,E),(b.e.f&me)!==0&&Be(b.e),b!==o){if(x!==void 0&&x.has(b)){if(d.length<M.length){var z=M[0],N;m=z.prev;var q=d[0],w=d[d.length-1];for(N=0;N<d.length;N+=1)pe(d[N],z,n);for(N=0;N<M.length;N+=1)x.delete(M[N]);Z(l,q.prev,w.next),Z(l,m,q),Z(l,w,z),o=z,m=w,E-=1,d=[],M=[]}else x.delete(b),pe(b,o,n),Z(l,b.prev,b.next),Z(l,b,m===null?l.first:m.next),Z(l,m,b),m=b;continue}for(d=[],M=[];o!==null&&o.k!==I;)(o.e.f&me)===0&&(x??=new Set).add(o),M.push(o),o=o.next;if(o===null)continue;b=o}d.push(b),m=b,o=b.next}if(o!==null||x!==void 0){for(var D=x===void 0?[]:$e(x);o!==null;)(o.e.f&me)===0&&D.push(o),o=o.next;var J=D.length;if(J>0){var ue=null;Dt(l,D,ue)}}t.first=l.first&&l.first.e,t.last=m&&m.e;for(var le of r.values())ze(le.e);r.clear()}function Ve(t,s,l,r){dt(t.v,s),t.i=l}function xe(t,s,l,r,n,i,v,h,_,y,g){var R=(_&_t)!==0,o=(_&mt)===0,x=R?o?vt(n,!1,!1):ke(n):n,m=(_&ht)===0?v:ke(v),d={i:m,v:x,k:i,a:null,e:null,prev:l,next:r};try{if(t===null){var M=document.createDocumentFragment();M.append(t=ut())}return d.e=Le(()=>h(t,x,m,y),H),d.e.prev=l&&l.e,d.e.next=r&&r.e,l===null?g||(s.first=d):(l.next=d,l.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function pe(t,s,l){for(var r=t.next?t.next.e.nodes_start:l,n=s?s.e.nodes_start:l,i=t.e.nodes_start;i!==null&&i!==r;){var v=gt(i);n.before(i),i=v}}function Z(t,s,l){s===null?t.first=l:(s.next=l,s.e.next=l&&l.e),l!==null&&(l.prev=s,l.e.prev=s&&s.e)}const Ye=[...` 	
\r\fÂ \v\uFEFF`];function Tt(t,s,l){var r=t==null?"":""+t;if(l){for(var n in l)if(l[n])r=r?r+" "+n:n;else if(r.length)for(var i=n.length,v=0;(v=r.indexOf(n,v))>=0;){var h=v+i;(v===0||Ye.includes(r[v-1]))&&(h===r.length||Ye.includes(r[h]))?r=(v===0?"":r.substring(0,v))+r.substring(h+1):v=h}}return r===""?null:r}function Ct(t,s){return t==null?null:String(t)}function He(t,s,l,r,n,i){var v=t.__className;if(H||v!==l||v===void 0){var h=Tt(l,r,i);(!H||h!==t.getAttribute("class"))&&(h==null?t.removeAttribute("class"):t.className=h),t.__className=l}else if(i&&n!==i)for(var _ in i){var y=!!i[_];(n==null||y!==!!n[_])&&t.classList.toggle(_,y)}return i}function kt(t,s,l,r){var n=t.__style;if(H||n!==s){var i=Ct(s);(!H||i!==t.getAttribute("style"))&&(i==null?t.removeAttribute("style"):t.style.cssText=i),t.__style=s}return r}function Pe(t,s,l=s){var r=new WeakSet;We(t,"input",async n=>{var i=n?t.defaultValue:t.value;if(i=we(t)?Ee(i):i,l(i),ae!==null&&r.add(ae),await Lt(),i!==(i=s())){var v=t.selectionStart,h=t.selectionEnd;t.value=i??"",h!==null&&(t.selectionStart=v,t.selectionEnd=Math.min(h,t.value.length))}}),(H&&t.defaultValue!==t.value||xt(s)==null&&t.value)&&(l(we(t)?Ee(t.value):t.value),ae!==null&&r.add(ae)),Fe(()=>{var n=s();if(t===document.activeElement){var i=yt??ae;if(r.has(i))return}we(t)&&n===Ee(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function we(t){var s=t.type;return s==="number"||s==="range"}function Ee(t){return t===""?null:+t}function Nt(t,s,l=s){We(t,"change",()=>{l(t.files)}),H&&t.files&&l(t.files),Fe(()=>{t.files=s()})}const Xt=""+new URL("../assets/image-.JfwN_-Fz.png",import.meta.url).href,Yt=""+new URL("../assets/0.d_JWpNXU.png",import.meta.url).href,Ht=""+new URL("../assets/0_base.CX9uhL0v.png",import.meta.url).href,Pt=""+new URL("../assets/1.j6m7dKLN.png",import.meta.url).href,$t=""+new URL("../assets/1_base.BZovD6fU.png",import.meta.url).href,Bt=(t,s,l,r)=>{u(s,null),u(l,1),u(r,0)},zt=(t,s,l,r,n,i)=>{if(e(s)){let v=!1;ne.show(),Promise.all([l(e(s).url),l(e(s).url_bg)]).then(([h,_])=>{const y=e(r).getContext("2d");if(!y)return;u(n,y,!0);const[g,R]=e(s).size;e(r).width=g,e(r).height=R,e(n).clearRect(0,0,g,R),e(n).drawImage(_,0,0,g,R),e(n).drawImage(e(i),0,0,g,R),e(n).drawImage(h,0,0,g,R)}).catch(h=>{v=!0,alert(h)}).finally(()=>{if(v)return;const h=new Date,_=o=>o.toString().padStart(2,"0"),y=`${h.getFullYear()}-${_(h.getMonth()+1)}-${_(h.getDate())}_${_(h.getHours())}-${_(h.getMinutes())}-${_(h.getSeconds())}`,g=e(r).toDataURL("image/png");if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){const o=atob(g.split(",")[1]),x=g.split(",")[0].split(":")[1].split(";")[0],m=new ArrayBuffer(o.length),d=new Uint8Array(m);for(let b=0;b<o.length;b++)d[b]=o.charCodeAt(b);const M=new Blob([m],{type:x}),Y=URL.createObjectURL(M),I=document.createElement("a");I.href=Y,I.download=`end-twbbn_${y}.png`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(Y)}else{const o=document.createElement("a");o.download=`end-twbbn_${y}.png`,o.href=g,o.click()}ne.hide()})}};var Wt=(t,s,l)=>u(s,e(l),!0),Ft=Q('<div><img class="svelte-1e7bg5l"/> <h4 class="title svelte-1e7bg5l"> </h4></div>'),Vt=Q('<div class="row"><div class="col-xs-12"><h2 class="text-center">PILIH FRAME</h2></div> <!></div>'),Zt=Q("<canvas></canvas>"),qt=(t,s)=>e(s).click(),Jt=Q('<img class="upload-plachoder svelte-1e7bg5l" alt="placaholder"/>'),Kt=(t,s,l)=>{s(),e(l).click()},Qt=Q('<div class="row"><fieldset class="col-xs-12"><label>ZOOM <input type="range" min="0.5" max="3" step="0.1"/></label></fieldset> <fieldset class="col-xs-12"><label>PUTAR <input type="range" min="-180" max="180" step="5"/></label></fieldset> <div class="col-xs-12 button-box svelte-1e7bg5l"><button class="button secondary svelte-1e7bg5l">UBAH FOTO</button></div></div>'),Gt=Q('<div class="row middle-xs"><div class="col-xs-12 col-lg-6"><div class="crop-container svelte-1e7bg5l"><!> <img class="frame svelte-1e7bg5l" alt="frame material"/></div></div> <div class="col-xs-12 col-lg-6"><!> <div class="row"><div class="col-xs-12 button-box svelte-1e7bg5l"><button class="button secondary svelte-1e7bg5l">UBAH FRAME</button></div></div></div></div>'),jt=Q('<footer class="svelte-1e7bg5l"><div class="container svelte-1e7bg5l"><div class="row center-xs"><div class="col-xs-12 col-md-6 col-lg-4 button-box svelte-1e7bg5l"><button class="svelte-1e7bg5l">DOWNLOAD</button></div></div></div></footer>'),ea=Q('<main class="container wrapper svelte-1e7bg5l"><!> <!></main> <!> <input type="file" accept="image/*" class="input-image svelte-1e7bg5l" required/> <canvas class="image-final svelte-1e7bg5l"></canvas>',1);function ia(t,s){It(s,!0);const l=[{title:"SQUARE",url:Yt,url_bg:Ht,size:[900,900]},{title:"POTRAIT",url:Pt,url_bg:$t,size:[900,1200]}];let r=T(null),n=T(null),i=T(null),v;const h=async a=>{const c=await createImageBitmap(a),f=1024,p=f/c.width,L=f,O=c.height*p,P=document.createElement("canvas");P.width=L,P.height=O,P.getContext("2d").drawImage(c,0,0,L,O);const F=await new Promise(B=>P.toBlob(B,"image/jpeg",.7));return URL.createObjectURL(F)};let _=T(null);ge(()=>{e(n)&&e(n)?.[0]?(ne.show(),h(e(n)[0]).then(a=>{URL.revokeObjectURL(v),v=a,u(_,a,!0),ne.hide()}).catch(a=>{u(_,v,!0),ne.hide()})):u(_,null)});const y=()=>{u(n,new DataTransfer().files,!0),u(D,1),u(J,0)};let g=T(!1),R=T(0),o=T(0),x=T(0),m=T(0),d=T(0);ge(()=>{e(w)&&(e(w).addEventListener("mousedown",a=>{M(a)}),e(w).addEventListener("mousemove",a=>{Y(a)}),e(w).addEventListener("mouseup",I),e(w).addEventListener("wheel",a=>{G(a)}),e(w).addEventListener("touchstart",a=>{E(a)}),e(w).addEventListener("touchmove",a=>{S(a)},{passive:!1}),e(w).addEventListener("touchend",C))});const M=a=>{u(g,!0),u(x,a.clientX,!0),u(m,a.clientY,!0)},Y=a=>{if(!e(g))return;a.preventDefault();const c=a.clientX-e(x),f=a.clientY-e(m);u(R,e(R)+c),u(o,e(o)+f),u(x,a.clientX,!0),u(m,a.clientY,!0)},I=()=>{u(g,!1)},b=a=>{const[c,f]=[a[0],a[1]],p=f.clientX-c.clientX,L=f.clientY-c.clientY;return Math.sqrt(p*p+L*L)},E=a=>{if(u(g,!0),a.touches.length===2)u(d,b(a.touches),!0);else{const c=a.touches[0];u(x,c.clientX,!0),u(m,c.clientY,!0)}},S=a=>{if(e(g))if(a.preventDefault(),a.touches.length===2){const c=b(a.touches),f=c/e(d);f>1.05?(u(D,Math.min(5,e(D)+.1),!0),u(d,c,!0)):f<.95&&(u(D,Math.max(.5,e(D)-.1),!0),u(d,c,!0))}else{const c=a.touches[0],f=c.clientX-e(x),p=c.clientY-e(m);u(R,e(R)+f),u(o,e(o)+p),u(x,c.clientX,!0),u(m,c.clientY,!0)}},C=()=>{u(g,!1)},G=a=>{a.preventDefault(),Math.sign(a.deltaY)>0?u(D,Math.max(.5,e(D)-.1),!0):u(D,Math.max(.5,e(D)+.1),!0)},z=a=>new Promise((c,f)=>{const p=new Image;p.onload=()=>c(p),p.onerror=()=>f(new Error(`Failed to load image: ${a}`)),p.src=a}),N=(a,c)=>{const f=document.createElement("canvas"),p=f.getContext("2d"),L=c*Math.PI/180;return c%180===0?(f.width=a.width,f.height=a.height):(f.width=a.height,f.height=a.width),p.translate(f.width/2,f.height/2),p.rotate(L),p.drawImage(a,-a.width/2,-a.height/2),f};let q=T(null),w=T(null),D=T(1),J=T(0);ge(()=>{e(r)?.url&&e(_)&&e(D)&&e(R)!==null&&e(o)!==null&&e(J)!==null&&z(e(_)).then(a=>{const c=e(w).getContext("2d");if(!c)return;u(q,c,!0);const f=N(a,e(J)),[p,L]=e(r).size;e(w).width=p,e(w).height=L,e(q).clearRect(0,0,p,L);const O=p/L,P=f.width/f.height;let W,F,$,B;P>O?(B=f.height/e(D),$=B*O):($=f.width/e(D),B=$/O),W=(f.width-$)/2,F=(f.height-B)/2,e(q).drawImage(f,W,F,$,B,e(R),e(o),p,L)}).catch(a=>{console.error(a)})});let ue=T(null),le=T(null);et(()=>{e(w)&&(e(w).removeEventListener("mousedown",a=>{M(a)}),e(w).removeEventListener("mousemove",a=>{Y(a)}),e(w).removeEventListener("mouseup",I),e(w).removeEventListener("wheel",a=>{G(a)}),e(w).removeEventListener("touchstart",a=>{E(a)}),e(w).removeEventListener("touchmove",a=>{S(a)}),e(w).removeEventListener("touchend",C))});var ye=ea(),ve=Ut(ye),Re=U(ve);{var Ze=a=>{var c=Vt(),f=X(U(c),2);St(f,17,()=>l,p=>p.title,(p,L)=>{var O=Ft();let P;O.__click=[Wt,r,L];var W=U(O),F=X(W,2),$=U(F,!0);A(F),A(O),ie(B=>{P=He(O,1,"col-xs-6 col-md-6 col-lg-4 box svelte-1e7bg5l",null,P,B),oe(W,"src",e(L).url),oe(W,"alt",e(L).title),Mt($,e(L).title)},[()=>({selected:e(r)?.url===e(L)?.url})]),K(p,O)}),A(c),te(3,c,()=>Ne,()=>({delay:60})),K(a,c)};se(Re,a=>{e(r)||a(Ze)})}var qe=X(Re,2);{var Je=a=>{var c=Gt(),f=U(c),p=U(f),L=U(p);{var O=V=>{var k=Zt();let j;be(k,ee=>u(w,ee),()=>e(w)),ie(ee=>j=He(k,1,"canvas svelte-1e7bg5l",null,j,ee),[()=>({isDrag:e(g)})]),te(3,k,()=>ce,()=>({delay:60})),K(V,k)},P=V=>{var k=Jt();k.__click=[qt,i],ie(()=>oe(k,"src",Xt)),te(3,k,()=>ce,()=>({delay:60})),K(V,k)};se(L,V=>{e(_)?V(O):V(P,!1)})}var W=X(L,2);A(p),A(f);var F=X(f,2),$=U(F);{var B=V=>{var k=Qt(),j=U(k),ee=U(j),Me=X(U(ee));Xe(Me),A(ee),A(j);var fe=X(j,2),De=U(fe),Se=X(U(De));Xe(Se),A(De),A(fe);var Oe=X(fe,2),je=U(Oe);je.__click=[Kt,y,i],A(Oe),A(k),Pe(Me,()=>e(D),he=>u(D,he)),Pe(Se,()=>e(J),he=>u(J,he)),te(3,k,()=>Ne,()=>({delay:60})),K(V,k)};se($,V=>{e(_)&&V(B)})}var Ue=X($,2),Ae=U(Ue),Ge=U(Ae);Ge.__click=[Bt,r,D,J],A(Ae),A(Ue),A(F),A(c),ie(()=>{kt(p,`aspect-ratio: ${e(r).size[0]}/${e(r).size[1]};`),oe(W,"src",e(r).url)}),te(3,W,()=>ce,()=>({delay:60})),K(a,c)};se(qe,a=>{e(r)&&a(Je)})}A(ve);var Ie=X(ve,2);{var Ke=a=>{var c=jt(),f=U(c),p=U(f),L=U(p),O=U(L);O.__click=[zt,r,z,le,ue,w],A(L),A(p),A(f),A(c),te(3,c,()=>ce,()=>({delay:60})),K(a,c)};se(Ie,a=>{e(r)&&e(_)&&a(Ke)})}var de=X(Ie,2);be(de,a=>u(i,a),()=>e(i));var Qe=X(de,2);be(Qe,a=>u(le,a),()=>e(le)),Nt(de,()=>e(n),a=>u(n,a)),K(t,ye),At()}Rt(["click"]);export{ia as component};
